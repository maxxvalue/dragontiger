<?php
$table="potakdb";	//‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£
$max=200;
$access_token = '4YlJlgw/oJC3ik03YOZ1RFUBrmTI8UvdlTnXLZ/bC6qyZk7nrEUWkExCHYyIss7CU8ZKk14baE6yh282T7SpO/4tPQDLs3BcBa0OcZkewK2i6N1sGbuZXmFoXwyOrLz7oyeblwRhqsdkTNn2wbkZxQdB04t89/1O/w1cDnyilFU=';

$content = file_get_contents('php://input');		//‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô line
$events = json_decode($content, true);			//‡πÅ‡∏Å‡πâ‡∏£‡∏∞‡∏´‡∏±‡∏™ json ‡∏ó‡∏µ‡πà line ‡∏™‡πà‡∏á‡∏°‡∏≤
require('function.php');				//‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÑ‡∏ß‡πâ
if (!is_null($events['events'])) {			//‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡πà‡∏á‡∏°‡∏≤‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà
	foreach ($events['events'] as $event) {		//‡∏ß‡∏ô‡∏•‡∏π‡∏õ‡πÉ‡∏ô array ‡∏ó‡∏µ‡∏•‡∏∞‡∏ï‡∏±‡∏ß
		$replyToken = $event['replyToken'];	//‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤  replyToken ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏≠‡∏™‡πà‡∏á‡∏Å‡∏•‡∏±‡∏ö
		$text=$event['message']['text'];	//‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ text
		$type=$event['message']['type'];	//‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ type
		$arr2=explode(" ",$text);					//‡πÅ‡∏¢‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏ú‡∏•
		$text=clear($text);					//‡∏Å‡∏≥‡∏à‡∏±‡∏î‡πÄ‡∏ß‡πâ‡∏ô‡∏ß‡∏£‡∏£‡∏Ñ‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡πá‡∏ô‡πÄ‡∏ï‡∏≠‡∏£‡πå
		$lineid=$event['source']['userId'];	//‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ userId ‡∏à‡∏≤‡∏Å‡πÑ‡∏•‡∏ô‡πå‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ lineid
		$groupid=$event['source']['groupId'];//‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ groupId ‡∏à‡∏≤‡∏Å‡πÑ‡∏•‡∏ô‡πå‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÉ‡∏ô‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ groupid
		$wrong=" ‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏Å‡∏≤‡∏£‡πÅ‡∏ó‡∏á‡∏ú‡∏¥‡∏î‚ùå";							//‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ñ‡πâ‡∏≤‡πÄ‡∏Å‡∏¥‡∏ô‡∏û‡∏¥‡∏°‡∏û‡πå‡∏û‡∏ô‡∏±‡∏ô‡∏ú‡∏¥‡∏î
		
		$url='https://api.line.me/v2/bot/profile/'.$lineid;	//‡∏Å‡∏≥‡∏´‡∏ô‡∏î url ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏™‡πà‡∏á‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ profile
		$headers=array('Authorization: Bearer ' . $access_token);//‡∏Å‡∏≥‡∏´‡∏ô‡∏î headers ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ profile
		$ch = curl_init($url);					//‡πÄ‡∏£‡∏¥‡πà‡∏° curl
		curl_setopt($ch, CURLOPT_RETURNTRANSFER,TRUE);		//‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ö‡∏ö‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö
		curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);		//‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ headers
		$result = curl_exec($ch);				//‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤‡πÑ‡∏õ‡πÉ‡∏´‡πâ‡πÑ‡∏•‡∏ô‡πå‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ result
		$res=json_decode($result,true);				//‡πÅ‡∏Å‡πâ json ‡πÄ‡∏õ‡πá‡∏ô array
		if($res['userId']==''){
			$url='https://api.line.me/v2/bot/group/'.$groupid.'/member/'.$lineid;	//‡∏Å‡∏≥‡∏´‡∏ô‡∏î url ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏™‡πà‡∏á‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ profile ‡πÅ‡∏ö‡∏ö group
			$headers=array('Authorization: Bearer ' . $access_token);//‡∏Å‡∏≥‡∏´‡∏ô‡∏î headers ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ profile
			$ch = curl_init($url);					//‡πÄ‡∏£‡∏¥‡πà‡∏° curl
			curl_setopt($ch, CURLOPT_RETURNTRANSFER,TRUE);		//‡∏õ‡∏£‡∏±‡∏ö‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ö‡∏ö‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö
			curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);		//‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤ headers
			$result = curl_exec($ch);				//‡∏™‡πà‡∏á‡∏Ñ‡πà‡∏≤‡πÑ‡∏õ‡πÉ‡∏´‡πâ‡πÑ‡∏•‡∏ô‡πå‡πÅ‡∏•‡∏∞‡∏£‡∏±‡∏ö‡∏Å‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏±‡∏ß‡πÅ‡∏õ‡∏£ result
			$res=json_decode($result,true);				//‡πÅ‡∏Å‡πâ json ‡πÄ‡∏õ‡πá‡∏ô array
		}
		$id=getid($lineid,$table);					//‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡πà‡∏ô ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏´‡∏≤ id ‡∏à‡∏≤‡∏Å lineid
		$netid=getid($lineid,'money');		//‡∏£‡∏±‡∏ö id ‡∏Ñ‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô
		$net=select($netid,'money','NET');	//‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
		$status=select(1,$table,"status");	//‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡∏≠‡∏ö
		$lap=select(1,$table,"NET");	//‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≠‡∏ö
		$sarop=select(1,$table,"admin");	//‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏ß‡πà‡∏≤‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏±‡∏á
		$poll=select(1,$table,'LineID');		//‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏£‡∏∏‡∏õ
		$bet=select(1,$table,'play');	//‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡∏≤
		$arr=str_split($text);						//‡πÅ‡∏¢‡∏Å‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤‡∏°‡∏≤‡∏ó‡∏µ‡∏•‡∏∞‡∏ï‡∏±‡∏ß‡πÄ‡∏Å‡πá‡∏ö‡πÑ‡∏ß‡πâ‡πÉ‡∏ô arr
		//‡∏ï‡∏±‡∏ß t ‡∏ô‡∏≥‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏õ‡∏•‡∏ß‡πà‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏ó‡∏á
		$ottf=array(1,2,3,4);
		//‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÉ‡∏´‡πâ‡∏ö‡∏≠‡∏ó‡πÅ‡∏à‡πâ‡∏á ‡∏ß‡πà‡∏≤‡πÉ‡∏´‡πâ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡∏Å‡πà‡∏≠‡∏ô
		if(($arr[0]=="t"||$arr[0]=="T")&&$status==1&&$id==0){
			$replytext="‡∏Ñ‡∏∏‡∏ì ".$res['displayName']." ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏û‡∏¥‡∏° play";
		}
		elseif(($arr[0]=="t"||$arr[0]=="T")&&$status==1){
			$sum=sum($id,$table);
			$i=0;
			$all=0;
			$btext=substr($text,1);
			$barr=str_split($btext);
			foreach($barr as $v){
				if(!in_array($v,$ottf)){
					$i=1;
				}
				else{
					$all++;
				}
			}
			if($net<($all*$bet)){
				$replytext="‚ùå‡∏Ñ‡∏∏‡∏ì ".$res['displayName']." ‡∏°‡∏µ‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡πÑ‡∏°‡πà‡πÄ‡∏û‡∏µ‡∏¢‡∏á‡∏û‡∏≠ ‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ $net ‡∏ö‡∏≤‡∏ó‚ùå";
			}
			elseif($i==1){
				$replytext="‚ùå‡∏Ñ‡∏∏‡∏ì ".$res['displayName'].$wrong;
			}
			else{
				if($sum!=0){
					clearpotak($id);
				}
				foreach($ottf as $v){
					if($barr[0]==$v||$barr[1]==$v||$barr[2]==$v||$barr[3]==$v){
						update($id,$table,'P'.$v,1);
						update($id,$table,'play',1);
					}
				}
				updatepotak();
				$var=bresult();
				$p1=$var[0];
				$p2=$var[1];
				$p3=$var[2];
				$p4=$var[3];
				if($sum==0){
					$replytext="‚û°Ô∏è‡∏Ñ‡∏∏‡∏ì ".$res['displayName']." ‡πÅ‡∏ó‡∏á‡∏Ç‡∏≤ $btext ‡∏Ç‡∏≤‡∏•‡∏∞ $bet ‡∏ö‡∏≤‡∏ó ‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ $net ‡∏ö‡∏≤‡∏ó
1-$p1 | 2-$p2 | 3-$p3 | 4-$p4";
				}
				else{
					$replytext="üîÄ‡∏Ñ‡∏∏‡∏ì ".$res['displayName']." ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ó‡∏á‡∏Ç‡∏≤ $btext ‡∏Ç‡∏≤‡∏•‡∏∞ $bet ‡∏ö‡∏≤‡∏ó ‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ $net ‡∏ö‡∏≤‡∏ó
1-$p1 | 2-$p2 | 3-$p3 | 4-$p4";
				}
			}
		}
		elseif(($arr[0]=="t"||$arr[0]=="T")&&$status==0){
			$replytext="‚ùå‡∏õ‡∏¥‡∏î‡∏£‡∏≠‡∏ö‡πÅ‡∏•‡πâ‡∏ß‚ùå";
		}
		//check ‡∏ï‡∏±‡∏ß‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡∏á
		if($text=='check'||$text=='Check'){
			$replytext=check($id,$bet,$net);
		}
		//check ‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô
		if($text=='@id'){
			$replytext="‡∏Ñ‡∏∏‡∏ì ".$res['displayName']." ‡∏¢‡∏≠‡∏î‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô $net ‡∏ö‡∏≤‡∏ó";
		}
		//‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡πÄ‡∏â‡∏û‡∏≤‡∏∞ admin
		if(select($id,$table,"admin")==1){
			//‡∏ñ‡πâ‡∏≤‡∏û‡∏¥‡∏°‡∏°‡∏≤‡∏ß‡πà‡∏≤ ‡∏õ‡∏£‡∏±‡∏ö ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô
			if($text=="‡∏õ‡∏£‡∏±‡∏ö"){								
				config($access_token,$groupid,$table);
				$replytext="‡∏≠‡∏±‡∏û‡πÄ‡∏î‡∏ó‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à";
			}
			//‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏≠‡∏ö ‡πÉ‡∏ä‡πâ‡∏ä‡πà‡∏≠‡∏á net ‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏ô‡∏±‡∏ö‡∏£‡∏≠‡∏ö
			if($type=="sticker"&&$status==0){
				if($sarop==0){
					$manymessage=2;
					update(1,$table,"status",1);
					update(1,$table,"admin",1);
					$replytext1='‚ô†Ô∏è‚ô•Ô∏è‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤‡πÇ‡∏õ‡πä‡∏∞‡πÅ‡∏ï‡∏Å‚ô¶Ô∏è‚ô£Ô∏è
¬ÆÔ∏è‡∏û‡∏¥‡∏°‡∏û‡πå play ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏Å‡πà‡∏≠‡∏ô¬ÆÔ∏è
‡∏û‡∏¥‡∏°‡∏û‡πå t ‡∏ï‡∏≤‡∏°‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏ó‡∏á ‡πÇ‡∏î‡∏¢‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡∏≤‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÑ‡∏ß‡πâ‡πÇ‡∏î‡∏¢‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô
‡∏Ç‡∏≤‡πÉ‡∏î‡∏°‡∏µ‡πÅ‡∏ï‡πâ‡∏°‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ó‡∏á‡∏à‡∏≤‡∏Å‡∏Ç‡∏≤‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏ñ‡πâ‡∏≤‡πÅ‡∏ó‡∏á‡∏ñ‡∏π‡∏Å 2 ‡∏Ñ‡∏ô ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ô‡∏•‡∏∞‡∏Ñ‡∏£‡∏∂‡πà‡∏á)';
					$replytext2="‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà ".$lap;
				}
				else{
					$replytext='‚ùå‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡πà‡∏≠‡∏ô‚ùå';
				}
			}
			//‡∏õ‡∏¥‡∏î‡∏£‡∏≠‡∏ö
			if($type=="sticker"&&$status==1){
				$manymessage=2;
				update(1,$table,"status",0);
				$replytext1='‚ô†Ô∏è‚ô•Ô∏è‡∏Å‡∏ï‡∏¥‡∏Å‡∏≤‡πÇ‡∏õ‡πä‡∏∞‡πÅ‡∏ï‡∏Å‚ô¶Ô∏è‚ô£Ô∏è
¬ÆÔ∏è‡∏û‡∏¥‡∏°‡∏û‡πå play ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏Å‡πà‡∏≠‡∏ô¬ÆÔ∏è
‡∏û‡∏¥‡∏°‡∏û‡πå t ‡∏ï‡∏≤‡∏°‡∏î‡πâ‡∏ß‡∏¢‡∏Ç‡∏≤‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏ó‡∏á ‡πÇ‡∏î‡∏¢‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ó‡∏µ‡πà‡∏•‡∏á‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏Ç‡∏≤‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÑ‡∏ß‡πâ‡πÇ‡∏î‡∏¢‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô‡∏î‡∏±‡∏á‡∏ô‡∏±‡πâ‡∏ô‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô
‡∏Ç‡∏≤‡πÉ‡∏î‡∏°‡∏µ‡πÅ‡∏ï‡πâ‡∏°‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏ó‡∏á‡∏à‡∏≤‡∏Å‡∏Ç‡∏≤‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏ñ‡πâ‡∏≤‡πÅ‡∏ó‡∏á‡∏ñ‡∏π‡∏Å 2 ‡∏Ñ‡∏ô ‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ñ‡∏ô‡∏•‡∏∞‡∏Ñ‡∏£‡∏∂‡πà‡∏á)';
				$replytext2="‡∏õ‡∏¥‡∏î‡∏£‡∏≠‡∏ö‡∏ó‡∏µ‡πà ".$lap;
			}
			//‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏≠‡∏ö‡πÅ‡∏£‡∏Å
			if($text=="op"||$text=="Op"){
				update(1,$table,"status",0);
				update(1,$table,"NET",1);
				update(1,$table,'admin',0);
				$replytext="‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏£‡∏≠‡∏ö‡πÅ‡∏£‡∏Å";
			}
			
			//‡∏õ‡∏£‡∏±‡∏ö‡∏ß‡πà‡∏≤‡∏•‡∏á‡∏ï‡∏≤‡∏•‡∏∞‡πÄ‡∏ó‡πà‡∏≤‡πÑ‡∏´‡∏£‡πà
			if($arr2[0]=='‡∏Ç‡∏≤‡∏•‡∏∞'&&$status==0){
				update(1,$table,'play',$arr2[1]);
				$replytext="‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ó‡∏á‡∏Ç‡∏≤‡∏•‡∏∞ $arr2[1] ‡∏ö‡∏≤‡∏ó";
			}
			//‡∏õ‡∏£‡∏±‡∏ö‡∏ß‡πà‡∏≤‡∏´‡∏±‡∏Å‡∏Å‡∏µ‡πà%
			if($arr2[0]=='%'){
				update(1,$table,'vat',$arr2[1]);
				$replytext="‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏±‡∏Å $arr2[1]%";
			}
			
			//‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏ï‡∏≠‡∏ô‡∏à‡∏ö‡∏£‡∏≠‡∏ö
			if(($arr[0]=="s"||$arr[0]=="S")&&$status==0){
				$replytext="‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏™‡∏£‡∏∏‡∏õ ‡∏Ç‡∏≤ $arr[1] ‡∏°‡∏µ‡πÅ‡∏ï‡πâ‡∏°‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‚ùì";
				update(1,$table,'LineID',$arr[1]);
			}
			elseif(($arr[0]=="s"||$arr[0]=="S")&&$status==1){
				$replytext='‚ùå‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏õ‡∏¥‡∏î‡∏£‡∏≠‡∏ö‡∏Å‡πà‡∏≠‡∏ô‚ùå';
			}
			//‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô
			if($text=="@ok"&&$poll!=0){
				if(in_array($poll,$ottf)){
					update($id,$table,'NET',$net);
					$replytext=resultpotak($poll);
					update($netid,'money','NET',select($id,$table,'NET'));
					update(1,$table,'LineID',0);
					update(1,$table,'admin',0);
					update(1,$table,"NET",$lap+1);
				}
				else{
					$replytext='‚ùå‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏¥‡∏î ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏™‡∏£‡∏∏‡∏õ‡πÉ‡∏´‡∏°‡πà‚ùå';
				}
			}
		}
		//‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô
		if(($text=="play"||$text=="Play")&&$id==0){
			$var=codename($res['displayName']);
			insert($table,$var,$lineid,0);
			if($netid==0){
				insert('money',$var,$lineid,1000);
			}
			$replytext="‡∏Ñ‡∏∏‡∏ì ".$res['displayName']." ‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß";
		}
		//‡∏ñ‡πâ‡∏≤‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô‡πÅ‡∏•‡πâ‡∏ß‡∏Å‡πá‡πÉ‡∏´‡πâ‡∏ö‡∏≠‡∏Å‡∏ß‡πà‡∏≤‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏•‡πà‡∏ô
		elseif(($text=="play"||$text=="Play")&&$id!=0){
			$replytext="‡∏Ñ‡∏∏‡∏ì ".$res['displayName']." ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÄ‡∏•‡πà‡∏ô‡πÅ‡∏•‡πâ‡∏ß";
		}
		
		//‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö
		$messages = [
			[
			'type' => 'text',
			'text' => $replytext
			]
		];
		if($manymessage==2){
			$messages = [
				[
				'type' => 'text',
				'text' => $replytext1
				],
				[
				'type' => 'text',
				'text' => $replytext2
				]
			];
		}
		$url = 'https://api.line.me/v2/bot/message/reply';		//url ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö
		$data = [
			'replyToken' => $replyToken,				//replayToken ‡πÉ‡∏™‡πà‡∏ï‡∏£‡∏á‡∏ô‡∏µ‡πâ
			'messages' => $messages,
		];
		$post = json_encode($data);						//web ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö
		$headers = array('Content-Type: application/json', 'Authorization: Bearer ' . $access_token);
														//headers ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö
		$ch = curl_init($url);							//‡πÄ‡∏£‡∏¥‡πà‡∏° curl 
		curl_setopt($ch, CURLOPT_CUSTOMREQUEST, "POST");//‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏ö‡∏ö post
		curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);	
		curl_setopt($ch, CURLOPT_POSTFIELDS, $post);	//‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏™‡πà‡∏á
		curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);	//‡∏™‡πà‡∏á header
		curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1);	
		curl_exec($ch);									//‡∏™‡πà‡∏á‡πÑ‡∏õ‡πÉ‡∏´‡πâ‡πÑ‡∏•‡∏ô‡πå‡∏ï‡∏≠‡∏ö‡∏Å‡∏•‡∏±‡∏ö
	}
}
